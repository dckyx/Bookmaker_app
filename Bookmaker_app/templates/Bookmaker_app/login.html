{% load static %}
{% load widget_tweaks %}
<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Logowanie</title>
{#  <link rel="stylesheet" href="{% static 'bookmaker_app/css/style.css' %}">#}
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    :root {
      --bg-color: #ffffff;
      --text-color: #000000;
      --panel-bg: #f0f0f0;
      --button-bg: #E14B4B;
      --button-text: #ffffff;
    }
    [data-theme='dark'] {
      --bg-color: #1a1a1a;
      --text-color: #f5f5f5;
      --panel-bg: #2b2b2b;
      --button-bg: #444;
      --button-text: #f5f5f5;
    }
    html, body {
      background-color: var(--bg-color);
      color: var(--text-color);
      transition: background-color 0.3s, color 0.3s;
    }
    .themed-panel {
      background-color: var(--panel-bg);
      color: var(--text-color);
      transition: background-color 0.3s, color 0.3s;
    }
    .btn-custom {
      background-color: var(--button-bg);
      color: var(--button-text);
      border: none;
      padding: 10px 20px;
      border-radius: 30px;
      font-weight: 600;
      font-size: 16px;
      transition: all 0.3s ease;
      width: 100%;
    }
    .btn-custom:hover {
      background-color: var(--text-color);
      color: var(--bg-color);
    }
    .theme-toggle {
      position: absolute;
      top: 20px;
      right: 20px;
      background-color: transparent;
      border: 2px solid var(--text-color);
      color: var(--text-color);
      padding: 8px 12px;
      border-radius: 8px;
      font-size: 18px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .theme-toggle:hover {
      background-color: var(--text-color);
      color: var(--bg-color);
    }
  </style>
</head>
<body id="MAIN_BODY" data-theme="light">
  <button id="theme-toggle" class="theme-toggle">
    <i id="theme-icon" class="bi bi-moon-fill"></i>
  </button>

  <div class="d-flex justify-content-center align-items-center vh-100 themed-panel">
    <div class="card shadow p-4 themed-panel" style="width: 100%; max-width: 400px;">
      <div class="text-center mb-3">
        <a href="{% url 'home' %}">
          <img id="logo-img" src="{% static 'bookmaker_app/images/logo_header.jpg' %}" alt="Logo" style="max-height: 60px; border-radius: 12px;">
        </a>
      </div>
      <h2 class="mb-4 text-center">Logowanie</h2>
      <form method="POST" novalidate>
        {% csrf_token %}
        <input type="hidden" name="next" value="{{ next }}">
        {% for field in form %}
          <div class="mb-3">
            <label class="form-label">{{ field.label }}</label>
            {{ field|add_class:"form-control themed-panel" }}
            {% if field.errors %}
              <div class="text-danger small">{{ field.errors|striptags }}</div>
            {% endif %}
          </div>
        {% endfor %}
        <button type="submit" class="btn btn-custom mt-2">Zaloguj się</button>
      </form>
      <p class="mt-3 text-center">
        Nie masz konta?
        <a href="{% url 'register' %}">Zarejestruj się</a>
      </p>
    </div>
  </div>

  <script>
    const root = document.documentElement;
    const themeToggleBtn = document.getElementById("theme-toggle");

    const themes = {
      light: {
        "--bg-color": "#ffffff",
        "--text-color": "#000000",
        "--panel-bg": "#f0f0f0",
        "--button-bg": "#E14B4B",
        "--button-text": "#ffffff"
      },
      dark: {
        "--bg-color": "#1a1a1a",
        "--text-color": "#f5f5f5",
        "--panel-bg": "#2b2b2b",
        "--button-bg": "#444",
        "--button-text": "#f5f5f5"
      }
    };

    function applyTheme(themeName) {
      const theme = themes[themeName];
      for (let key in theme) {
        root.style.setProperty(key, theme[key]);
      }
      document.body.setAttribute("data-theme", themeName);
      localStorage.setItem("theme", themeName);
      document.getElementById("theme-icon").className = themeName === "dark" ? "bi bi-sun-fill" : "bi bi-moon-fill";
      const logoImg = document.getElementById("logo-img");
      if (logoImg) {
        const darkLogo = "/static/bookmaker_app/images/logo_header_dark.jpg";
        const lightLogo = "/static/bookmaker_app/images/logo_header.jpg";
        logoImg.src = themeName === "dark" ? darkLogo : lightLogo;
      }
    }

    const saved = localStorage.getItem("theme") || "light";
    applyTheme(saved);

    themeToggleBtn?.addEventListener("click", () => {
      const current = localStorage.getItem("theme") || "light";
      const newTheme = current === "dark" ? "light" : "dark";
      applyTheme(newTheme);
    });
  </script>
</body>
</html>
